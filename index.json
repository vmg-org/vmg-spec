{"swagger":2,"info":{"description":"API specification for VMG project","version":"1.0.0","title":"VMG","termsOfService":"","contact":{"name":"vidmerg@gmail.com"},"license":{"name":"Apache 2.0","url":"http://www.apache.org/licenses/LICENSE-2.0.html"}},"host":"localhost:3000","basePath":"/api","schemes":["http","https"],"paths":{"/r1000":{"get":{"operationId":"r1000","tags":["auth_issuer"],"summary":"Get auth providers","parameters":[],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/auth_issuer"}}}}}},"/r1001":{"get":{"operationId":"r1001","tags":["movie_template"],"summary":"Get top movie templates (10 newest)","parameters":[],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/movie_template"}}}}}},"/r1002":{"get":{"operationId":"r1002","tags":["movie_template"],"summary":"Get a movie_template with movie_creator_item and movie_genre_item with genre_tag_item","parameters":[{"in":"query","name":"id","type":"integer","description":"id of movie_template","required":true}],"responses":{"200":{"description":"Success","schema":{"$ref":"#/definitions/movie_template"}}}}},"/r1003":{"get":{"operationId":"r1003","tags":["user_session"],"summary":"Get own user_session, including social_profile_item","parameters":[],"responses":{"200":{"description":"Success","schema":{"$ref":"#/definitions/user_session"}}},"security":{}}},"/r1004":{"get":{"operationId":"r1004","tags":["file_cut"],"summary":"Get array of file_cut with media_file_item, created by any user","parameters":[{"in":"query","name":"id_of_media_spec","type":"integer","description":"id of media_spec, id of episode bid","required":true}],"responses":{"200":{"description":"Success","schema":{"$ref":"#/definitions/file_cut"}}}}},"/r1005":{"get":{"operationId":"r1005","tags":["job_source"],"summary":"Get job_source with status and media_spec and source_file (if exists)","parameters":[{"in":"query","name":"id_of_media_spec","type":"integer","description":"id of job_source (media_spec too)","required":true}],"responses":{"200":{"description":"Success","schema":{"$ref":"#/definitions/job_source"}}},"security":{}}},"/r1006":{"get":{"operationId":"r1006","tags":["job_output"],"summary":"Get job_output with status and media_spec and file_output (if exists)","parameters":[{"in":"query","name":"id_of_media_spec","type":"integer","description":"id of job_output (id_of_media_spec)","required":true}],"responses":{"200":{"description":"Success","schema":{"$ref":"#/definitions/job_output"}}},"security":{}}},"/r1007":{"get":{"operationId":"r1007","tags":["job_cut"],"summary":"Get job_cut with status and media_spec and file_output (if exists)","parameters":[{"in":"query","name":"id_of_media_spec","type":"integer","description":"id of job_cut (id_of_media_spec)","required":true}],"responses":{"200":{"description":"Success","schema":{"$ref":"#/definitions/job_cut"}}},"security":{}}},"/r1008":{"get":{"operationId":"r1008","tags":["episode_bid"],"summary":"Get episode_bid with episode_template_item (with movie_template_item) and media_spec_item with all jobs","parameters":[{"in":"query","name":"id_of_media_spec","type":"integer","description":"id of episode_bid (id_of_media_spec)","required":true}],"responses":{"200":{"description":"Success","schema":{"$ref":"#/definitions/episode_bid"}}}}},"/r1009":{"get":{"operationId":"r1009","tags":["episode_template"],"summary":"Get episode_template_arr, fitered by id_of_movie_template, with episode_bid_count and episode_bid_count_ready; order by order_in_movie","parameters":[{"in":"query","name":"id_of_movie_template","type":"integer","description":"id of movie template","required":true}],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/episode_template"}}}}}},"/r1010":{"get":{"operationId":"r1010","tags":["episode_bid"],"summary":"Get episode_bid_arr, filtered by array of id_of_episode_template; which created by current user_profile","parameters":[{"in":"query","name":"id_of_episode_template_arr","type":"array","collectionFormat":"csv","items":{"type":"integer"},"description":"array: id of episode template","required":true}],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/episode_bid"}}}},"security":{}}},"/r1011":{"get":{"operationId":"r1011","tags":["episode_bid"],"summary":"Get not-uploaded episode_bid_arr, created by current user_profile: usually it - one record (or null)","parameters":[],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/episode_bid"}}}},"security":{}}},"/r1012":{"get":{"operationId":"r1012","tags":["movie_template"],"summary":"Get movie_template_arr where created <= now < finished, created by current user","parameters":[],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/movie_template"}}}},"security":{}}},"/r1014":{"get":{"operationId":"r1014","tags":["episode_bid"],"summary":"Get episode_bid_arr where media_spec.is_ready = true, created by current user. With episode_template_item with movie_template_item","parameters":[],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/episode_bid"}}}},"security":{}}},"/r1015":{"get":{"operationId":"r1015","tags":["episode_bid"],"summary":"Get episode_bid_arr where media_spec.is_ready = true, created by any user. With media_spec_item and bid_check_item. Filtered by id_of_episode_template","parameters":[{"in":"query","name":"id_of_episode_template","type":"integer","description":"id of episode_template","required":true}],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/episode_bid"}}}}}},"/r1016":{"get":{"operationId":"r1016","tags":["episode_template"],"summary":"Get episode_template_arr with episode_bid_item_best with media_spec_item with file_cut_item with media_file_item. Filtered by id_of_movie_template","parameters":[{"in":"query","name":"id_of_movie_template","type":"integer","description":"id of movie_template","required":true}],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/episode_template"}}}}}},"/r1017":{"get":{"operationId":"r1017","tags":["movie_template"],"summary":"Get movie_template_arr, where episode_bid_best_count = 3","parameters":[],"responses":{"200":{"description":"Success","schema":{"type":"array","items":{"$ref":"#/definitions/movie_template"}}}}}},"/w2000":{"post":{"tags":["movie_template"],"summary":"Create a movie_template with episode_template_arr and movie_genre_item. Update - if id exists","parameters":[{"in":"body","name":"body","description":"movie_template with episode_template_arr","schema":{"$ref":"#/definitions/movie_template"},"required":true}],"security":{},"operationId":"w2000"}},"/w2001":{"post":{"tags":["user_session"],"summary":"Create an user session","parameters":[{"in":"body","name":"body","description":"User session","required":true,"schema":{"$ref":"#/definitions/user_session"}}],"operationId":"w2001"}},"/w2002":{"post":{"tags":["episode_bid"],"summary":"Create a episode_bid with empty media_spec","parameters":[{"in":"body","name":"body","description":"episode_bid with media_spec_item","required":true,"schema":{"$ref":"#/definitions/episode_bid"}}],"security":{},"operationId":"w2002"}},"/w2003":{"post":{"tags":["job_source"],"summary":"Create a job to create a source file (upload to a cloud)","parameters":[{"in":"body","name":"body","description":"job_source","required":true,"schema":{"$ref":"#/definitions/job_source"}}],"security":{},"operationId":"w2003"}},"/w2004":{"post":{"tags":["job_output"],"summary":"Create a job to generate output files from a source file","parameters":[{"in":"body","name":"body","description":"job_output","required":true,"schema":{"$ref":"#/definitions/job_output"}}],"security":{},"operationId":"w2004"}},"/w2005":{"post":{"tags":["job_cut"],"summary":"Create a job to cut output files","parameters":[{"in":"body","name":"body","description":"job_cut","required":true,"schema":{"$ref":"#/definitions/job_cut"}}],"security":{},"operationId":"w2005"}},"/w2007":{"post":{"tags":["bid_check"],"summary":"Create a bid_check record, delete if is_approved === null","parameters":[{"in":"body","name":"body","description":"bid_check","required":true,"schema":{"$ref":"#/definitions/bid_check"}}],"security":{},"operationId":"w2007"}},"/w2008":{"post":{"tags":["bid_rating"],"summary":"Create a bid_rating record, delete if rating === null","parameters":[{"in":"body","name":"body","description":"bid_rating","required":true,"schema":{"$ref":"#/definitions/bid_rating"}}],"security":{},"operationId":"w2008"}},"/w2009":{"post":{"tags":["job_output"],"summary":"DELETE a job_output. Delete array of file_output for this job. Delete array of media_file for this job. Delete these files from a file storage, and their snapshots (if exist).","parameters":[{"in":"body","name":"body","description":"job_output","required":true,"schema":{"$ref":"#/definitions/job_output"}}],"security":{},"operationId":"w2009"}},"/w2010":{"post":{"tags":["episode_bid"],"summary":"DELETE an episode_bid with a media_spec and media_owner. Only if not yet uploaded. Like an empty bid","parameters":[{"in":"body","name":"body","description":"episode_bid","required":true,"schema":{"$ref":"#/definitions/episode_bid"}}],"security":{},"operationId":"w2010"}},"/w2011":{"post":{"tags":["user_session"],"summary":"Log out, remove an user_session","parameters":[{"in":"body","name":"body","description":"user_session, might be empty, removes by session id in the AUTH header","required":true,"schema":{"$ref":"#/definitions/user_session"}}],"security":{},"operationId":"w2011"}},"/w2012":{"post":{"tags":["job_source"],"summary":"DELETE a job_source. Delete a file_source for this job. Delete a media_file for this job. Delete files from a cloud storage, and their snapshots (if exist).","parameters":[{"in":"body","name":"body","description":"job_source","required":true,"schema":{"$ref":"#/definitions/job_source"}}],"security":{},"operationId":"w2012"}}},"definitions":{"auth_issuer":{"primaryKey":"id","properties":{"id":{"type":"string","maxLength":10,"description":"Id of auth issuer, like goog or fb","required":true},"name":{"type":"string","maxLength":50,"description":"Display name of an issuer, like Google or Facebook","required":true},"url":{"type":"string","maxLength":255,"description":"Main url of an issuer","required":true}}},"bid_check":{"primaryKey":"id_of_media_spec","properties":{"id_of_media_spec":{"type":"integer","description":"Id of a bid","zref":{"mdl":"episode_bid","fld":"id_of_media_spec","del":"cascade"},"required":true},"is_approved":{"type":"boolean","description":"Whether the bid is approved (true) or declined (false)","required":true},"description":{"type":"string","maxLength":800,"description":"Message for an user if the bid is declined","required":true},"created":{"type":"integer","description":"When checked, unix timestamp","required":true}}},"bid_rating":{"primaryKey":"id_of_media_spec","properties":{"id_of_media_spec":{"type":"integer","description":"Id of a bid","zref":{"mdl":"episode_bid","fld":"id_of_media_spec","del":"cascade"},"required":true},"rating":{"type":"integer","format":"int16","description":"1, 2, 3 places","required":true},"created":{"type":"integer","description":"When checked, unix timestamp","required":true}}},"container_format":{"primaryKey":"id","properties":{"id":{"type":"string","description":"Container format abbr","maxLength":100,"required":true},"description":{"type":"string","description":"Format description","maxLength":800,"required":true}}},"episode_bid":{"primaryKey":"id_of_media_spec","properties":{"id_of_media_spec":{"type":"integer","description":"Id of media spec","zref":{"mdl":"media_spec","fld":"id","del":"cascade"},"required":true},"id_of_episode_template":{"type":"integer","description":"Id of episode template","zref":{"mdl":"episode_template","fld":"id","del":"restrict"},"required":true},"created":{"type":"integer","description":"Create date, unix timestamp","required":true}}},"episode_template":{"primaryKey":"id","properties":{"id":{"type":"integer","description":"Id of a template of an episode","required":true},"name":{"type":"string","description":"Name of an episode","maxLength":255,"minLength":5,"required":true},"story":{"type":"string","description":"Story of an episode","maxLength":400,"minLength":100,"required":true},"conds":{"type":"string","description":"Conditions, required for snapping this episode","maxLength":255,"required":true},"order_in_movie":{"type":"integer","description":"Sequential order in a movie","required":true},"guide_photo_url":{"type":"string","description":"A photo described this episode","maxLength":2000,"required":true},"id_of_movie_template":{"type":"integer","description":"Id of a parent","zref":{"mdl":"movie_template","fld":"id","del":"cascade"},"required":true}}},"file_cut":{"primaryKey":["id_of_media_spec","id_of_media_file"],"properties":{"id_of_media_spec":{"type":"integer","description":"Media spec id","zref":{"mdl":"media_spec","fld":"id","del":"restrict"},"required":true},"id_of_media_file":{"type":"integer","description":"Media file id","zref":{"mdl":"media_file","fld":"id","del":"cascade"},"required":true}}},"file_output":{"primaryKey":["id_of_media_spec","id_of_media_file"],"properties":{"id_of_media_spec":{"type":"integer","description":"Media spec id","zref":{"mdl":"media_spec","fld":"id","del":"restrict"},"required":true},"id_of_media_file":{"type":"integer","description":"Media file id","zref":{"mdl":"media_file","fld":"id","del":"cascade"},"required":true}}},"file_source":{"primaryKey":"id_of_media_spec","properties":{"id_of_media_spec":{"type":"integer","description":"Id of a media spec","zref":{"mdl":"media_spec","fld":"id","del":"restrict"},"required":true},"id_of_media_file":{"type":"integer","description":"Id of a media file","zref":{"mdl":"media_file","fld":"id","del":"cascade"},"required":true}}},"genre_tag":{"primaryKey":"id","properties":{"id":{"type":"string","description":"Id of genre","maxLength":50,"minLength":3,"required":true},"name":{"type":"string","description":"Name of genre (tag)","maxLength":255,"minLength":3,"required":true},"color":{"type":"string","description":"Color of genre","maxLength":50,"required":true}}},"job_cut":{"primaryKey":"id_of_media_spec","properties":{"id_of_media_spec":{"type":"integer","description":"Media spec id - id of job","zref":{"mdl":"media_spec","fld":"id","del":"cascade"},"required":true},"id_of_et_job":{"type":"string","maxLength":255,"description":"The id that Elastic Transcoder assigned to the job","required":true},"id_of_job_status":{"type":"string","maxLength":50,"description":"Status, like submitted, progressind...","zref":{"mdl":"job_status","fld":"id","del":"restrict"},"required":true},"status_detail":{"type":"string","maxLength":800,"description":"Desc of error or other status","required":true},"cutting_start":{"type":"integer","format":"int64","description":"Start position to cut, in ms","required":true},"cutting_stop":{"type":"integer","format":"int64","description":"Stop position to cut, in ms","required":true}}},"job_output":{"primaryKey":"id_of_media_spec","properties":{"id_of_media_spec":{"type":"integer","description":"Media spec id - id of job","zref":{"mdl":"media_spec","fld":"id","del":"cascade"},"required":true},"id_of_et_job":{"type":"string","maxLength":255,"description":"The id that Elastic Transcoder assigned to the job","required":true},"id_of_job_status":{"type":"string","maxLength":50,"description":"Status, like submitted, progressind...","zref":{"mdl":"job_status","fld":"id","del":"restrict"},"required":true},"status_detail":{"type":"string","maxLength":800,"description":"Desc of error or other status","required":true}}},"job_source":{"primaryKey":"id_of_media_spec","properties":{"id_of_media_spec":{"type":"integer","description":"This job for this media spec","zref":{"mdl":"media_spec","fld":"id","del":"cascade"},"required":true},"id_of_container_format":{"type":"string","maxLength":50,"description":"mime type","zref":{"mdl":"container_format","fld":"id","del":"restrict"},"required":true},"url_to_upload":{"type":"string","maxLength":2000,"description":"Url to upload the result file","required":true},"url_to_read":{"type":"string","maxLength":2000,"description":"Url to read the resulted file","required":true}}},"job_status":{"primaryKey":"id","properties":{"id":{"type":"string","maxLength":50,"description":"Id of status","required":true},"description":{"type":"string","maxLength":800,"description":"Desc of status","required":true}}},"media_file":{"primaryKey":"id","properties":{"id":{"type":"integer","description":"Id of a media file with specific multimedia container format","required":true},"id_of_container_format":{"type":"string","description":"Id of a container format","maxLength":100,"zref":{"mdl":"container_format","fld":"id","del":"restrict"},"required":true},"url":{"type":"string","description":"Url to the file","maxLength":2000,"required":true},"size":{"type":"integer","description":"Size in bytes","format":"int64","required":true},"duration":{"type":"integer","format":"int64","description":"Original file and cutted files have diff duration, in milliseconds","required":true}}},"media_owner":{"primaryKey":["id_of_media_spec","id_of_user_profile"],"properties":{"id_of_media_spec":{"type":"integer","description":"Object role","zref":{"mdl":"media_spec","fld":"id","del":"cascade"},"required":true},"id_of_user_profile":{"type":"integer","description":"Subject role","zref":{"mdl":"user_profile","fld":"id","del":"cascade"},"required":true}}},"media_spec":{"primaryKey":"id","properties":{"id":{"type":"integer","description":"Id of media specification","required":true},"name":{"type":"string","description":"Name of media (from episode name or from an user)","maxLength":255,"required":true},"created":{"type":"integer","description":"Created, unix timestamp","required":true},"preview_img_url":{"type":"string","description":"Image from a video to show as thumbnail","maxLength":3200,"required":true},"is_ready":{"type":"boolean","description":"Whether the media have all converted and cutted media files","required":true}}},"movie_creator":{"primaryKey":"id_of_movie_template","properties":{"id_of_movie_template":{"type":"integer","description":"Movie","zref":{"mdl":"movie_template","fld":"id","del":"cascade"},"required":true},"id_of_user_profile":{"type":"integer","description":"Subject role","zref":{"mdl":"user_profile","fld":"id","del":"cascade"},"required":true}}},"movie_genre":{"primaryKey":"id_of_movie_template","properties":{"id_of_movie_template":{"type":"integer","description":"Id of movie template","zref":{"mdl":"movie_template","fld":"id","del":"cascade"},"required":true},"id_of_genre_tag":{"type":"string","description":"Id of genre (tag)","maxLength":50,"minLength":3,"zref":{"mdl":"genre_tag","fld":"id","del":"restrict"},"required":true},"color_schema":{"type":"string","description":"Schema for current genre for this movie, like image with color picker","maxLength":8000,"required":true}}},"movie_template":{"primaryKey":"id","properties":{"id":{"type":"integer","description":"Id of movie template","required":true},"name":{"type":"string","description":"Name of movie (template)","maxLength":255,"minLength":3,"required":true},"duration_of_episodes":{"type":"integer","description":"Duration of each episode","required":true},"preview_img_url":{"type":"string","description":"Preview of the movie","maxLength":2000,"required":true},"created":{"type":"integer","description":"When the template is created, unix timestamp","required":true},"finished":{"type":"integer","description":"When the template is closed, unix timestamp","required":true}}},"social_profile":{"primaryKey":"id","properties":{"id":{"type":"string","maxLength":255,"description":"Id of social profile, authIssuer id_SNID","required":true},"snid":{"type":"string","maxLength":250,"description":"Id of social profile in social network","required":true},"id_of_auth_issuer":{"type":"string","maxLength":10,"description":"Id of an issuer from auth_issuer table","zref":{"mdl":"auth_issuer","fld":"id","del":"restrict"},"required":true},"id_of_user_profile":{"type":"integer","description":"Id of user profile","zref":{"mdl":"user_profile","fld":"id","del":"cascade"},"required":true},"display_name":{"type":"string","maxLength":255,"description":"Display name from a social network","required":true},"first_name":{"type":"string","maxLength":255,"description":"First (given) name","required":true},"last_name":{"type":"string","maxLength":255,"description":"Last (family) name","required":true}}},"user_premedia":{"primaryKey":"id_of_user_profile","uniqueKey":[["id_of_media_spec"]],"properties":{"id_of_user_profile":{"type":"integer","description":"Id of a profile","zref":{"mdl":"user_profile","fld":"id","del":"restrict"},"required":true},"id_of_media_spec":{"type":"integer","description":"Premedia id","zref":{"mdl":"media_spec","fld":"id","del":"cascade"},"required":true}}},"user_profile":{"primaryKey":"id","properties":{"id":{"type":"integer","description":"Id of profile","required":true},"is_blocked":{"type":"boolean","description":"Whether the user is blocked","required":true}}},"user_session":{"primaryKey":"id","properties":{"id":{"type":"string","maxLength":8000,"description":"Id of user session","required":true},"social_token":{"type":"string","maxLength":7990,"description":"Access token, issued by auth provider","required":true},"id_of_social_profile":{"type":"string","maxLength":255,"description":"Id of social profile: iss_snid","zref":{"mdl":"social_profile","fld":"id","del":"cascade"},"required":true},"id_of_auth_issuer":{"type":"string","maxLength":10,"description":"Id of auth issuer, like fb or goog","zref":{"mdl":"auth_issuer","fld":"id","del":"restrict"},"required":true},"expires_at":{"type":"integer","description":"When the token is expired, unix timestamp","required":true},"created":{"type":"integer","description":"When the session is created","required":true}}}}}